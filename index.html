<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arnold Cat Map</title>
    <link rel="stylesheet" href="css/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
  </head>
  <body>
    <!-- ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ -->
    <nav>
      <div class="nav-logo">Arnold<span>CatMap</span></div>
      <button
        class="nav-hamburger"
        id="nav-hamburger"
        aria-label="Toggle navigation"
        aria-expanded="false"
        onclick="toggleNav()"
      >
        <span></span>
        <span></span>
        <span></span>
      </button>
      <div class="nav-links" id="nav-links">
        <button class="nav-tab active" onclick="showPage('animation', this)">
          Animation
        </button>
        <!-- <button class="nav-tab" onclick="showPage('iterations', this)">All Iterations</button> -->
        <!-- <button class="nav-tab"        onclick="showPage('hta',        this)">Step-by-Step</button> -->
        <button class="nav-tab" onclick="showPage('about', this)">About</button>
      </div>
    </nav>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PAGE 1 ‚Äî ANIMATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-animation" class="page active">
      <div class="hero">
        <h1><em>Animate</em> the Cat Map</h1>
        <p class="hero-sub">
          Enter pixel size, upload an image, and choose a matrix to watch the
          encryption process evolve.
        </p>
      </div>

      <div class="wrap">
        <!-- AFTER -->
        <div class="anim-layout">
          <!-- Left: upload panel -->
          <div class="anim-sidebar">
            <div class="panel">
              <div class="panel-head"><span class="dot"></span>Image</div>
              <div class="sidebar-body">
                <div>
                  <label class="field-label">Pixel Size</label>
                  <input
                    type="number"
                    id="anim-size"
                    value="16"
                    min="2"
                    max="500"
                    style="width: 80px"
                    onchange="animOnSizeChange()"
                  />
                  <p
                    id="anim-size-error"
                    class="input-error"
                    style="display: none"
                  >
                    Maximum size is 500
                  </p>
                </div>
                <label class="upload-box" id="anim-upload-box" for="anim-file">
                  <span class="up-icon" id="anim-upload-icon">üìÇ</span>
                  <div class="up-lbl" id="anim-upload-lbl">Upload image</div>
                  <p id="anim-upload-sub">PNG / JPG / GIF</p>
                  <input
                    type="file"
                    id="anim-file"
                    accept="image/*"
                    onchange="animOnUpload(this)"
                  />
                </label>
              </div>
            </div>
            <div id="anim-period-info" class="period-badge">
              Image returns in
              <strong id="anim-period-val" style="color: var(--accent3)"
                >?</strong
              >
              steps
            </div>
          </div>

          <!-- Centre: canvas + progress bar -->
          <div>
            <div class="canvas-wrap">
              <canvas
                id="anim-canvas"
                width="16"
                height="16"
                role="img"
                aria-label="Arnold Cat Map canvas"
                aria-describedby="anim-canvas-desc"
              >
              </canvas>
              <p id="anim-canvas-desc" class="sr-only" aria-live="polite">
                Iteration 0
              </p>
              <div class="canvas-badge">
                Iteration: <span class="n" id="anim-n">0</span>
              </div>
              <button
                class="canvas-download"
                onclick="animSaveFrame()"
                aria-label="Save current frame as PNG"
              >
                <i class="fa-solid fa-file-arrow-down"></i>
              </button>
            </div>
            <div class="progress-wrap">
              <div class="progress-track">
                <div class="progress-fill" id="anim-progress"></div>
              </div>
              <div class="progress-labels">
                <span>n = 0</span>
                <span id="anim-period-lbl">period = ?</span>
              </div>
            </div>
          </div>

          <!-- Right: matrix + playback panels -->
          <div class="anim-sidebar">
            <div class="panel">
              <div class="panel-head">
                <span class="dot dot-purple"></span>Playback
              </div>
              <div class="sidebar-body">
                <div class="speed-stepper">
                  <label class="field-label" style="font-size: 1rem"
                    >Timestep:
                  </label>

                  <button
                    class="speed-btn"
                    onclick="changeTimestep(-50)"
                    aria-label="Decrease timestep"
                  >
                    ‚àí
                  </button>
                  <span id="speed-lbl">300ms</span>
                  <button
                    class="speed-btn"
                    onclick="changeTimestep(50)"
                    aria-label="Increase timestep"
                  >
                    +
                  </button>
                </div>
                <div class="btn-row">
                  <button
                    class="btn btn-step"
                    aria-label="Step backward one iteration"
                    onclick="animStep(-1)"
                  >
                    ‚Üê Back
                  </button>
                  <button
                    class="btn btn-step"
                    aria-label="Step forward one iteration"
                    onclick="animStep(1)"
                  >
                    Forward ‚Üí
                  </button>
                </div>
                <button
                  class="btn btn-cyan"
                  id="anim-play-btn"
                  onclick="animToggle()"
                  style="width: 100%"
                >
                  ‚ñ∂ Animate
                </button>
              </div>
            </div>

            <div class="panel">
              <div class="panel-head">
                <span class="dot dot-red"></span>Matrix
              </div>
              <div class="sidebar-body">
                <div class="matrix-grid">
                  <div class="matrix-cell">
                    <input
                      type="number"
                      id="aa11"
                      value="1"
                      min="0"
                      onChange="animOnMatrixChange()"
                    />
                  </div>
                  <div class="matrix-cell">
                    <input
                      type="number"
                      id="aa12"
                      value="1"
                      min="0"
                      onChange="animOnMatrixChange()"
                    />
                  </div>
                  <div class="matrix-cell">
                    <input
                      type="number"
                      id="aa21"
                      value="1"
                      min="0"
                      onChange="animOnMatrixChange()"
                    />
                  </div>
                  <div class="matrix-cell">
                    <input
                      type="number"
                      id="aa22"
                      value="0"
                      min="0"
                      onChange="animOnMatrixChange()"
                    />
                  </div>
                </div>
              </div>
            </div>
            <button
              class="btn btn-ghost"
              onclick="animReset()"
              aria-label="Reset to original image"
              style="background: rgba(59, 191, 191, 0.1)"
            >
              ‚Ü∫ Reset
            </button>
          </div>
        </div>
      </div>
      <p></p>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PAGE 2 ‚Äî ALL ITERATIONS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- <div id="page-iterations" class="page">
  <div class="hero">
    <div class="hero-eyebrow">Discrete Dynamical System</div>
    <h1>See<br><em>All Iterations</em></h1>
    <p class="hero-sub">
      It's tough to just click through or let it animate ‚Äî so here every iteration
      is laid out at once. Does it always come back? And does it always come back
      after the same number of steps?
    </p>
    <div class="formula-pill">
      (x‚Ä≤, y‚Ä≤) = ( a‚ÇÅ‚ÇÅx + a‚ÇÅ‚ÇÇy , a‚ÇÇ‚ÇÅx + a‚ÇÇ‚ÇÇy ) mod N
      <span>det = 1</span>
    </div>
  </div>

  <div class="wrap">

    <-- Controls bar -->
    <!-- <div class="iter-controls">

      <div class="iter-cg" style="min-width:148px;">
        <label class="upload-box" id="anim-upload-box" for="anim-file">
  <span class="up-icon" id="anim-upload-icon">üìÇ</span>
  <div class="up-lbl" id="anim-upload-lbl">Upload image</div>
  <p id="anim-upload-sub">PNG / JPG / GIF</p>
  <input type="file" id="anim-file" accept="image/*" onchange="animOnUpload(this)">
</label>
      </div>

      <div class="iter-cg">
        <label class="field-label">Image size</label>
        <input type="number" id="iter-size" value="16" min="2" max="500"
          style="width:80px;" onchange="animOnSizeChange()">
      </div>

      <div class="iter-cg">
        <label class="field-label">Matrix</label>
        <div class="matrix-grid">
          <div class="matrix-cell">
            <label class="field-label">a‚ÇÅ‚ÇÅ</label>
            <input type="number" id="ia11" value="1" min="0" style="width:56px;">
          </div>
          <div class="matrix-cell">
            <label class="field-label">a‚ÇÅ‚ÇÇ</label>
            <input type="number" id="ia12" value="1" min="0" style="width:56px;">
          </div>
          <div class="matrix-cell">
            <label class="field-label">a‚ÇÇ‚ÇÅ</label>
            <input type="number" id="ia21" value="1" min="0" style="width:56px;">
          </div>
          <div class="matrix-cell">
            <label class="field-label">a‚ÇÇ‚ÇÇ</label>
            <input type="number" id="ia22" value="0" min="0" style="width:56px;">
          </div>
        </div>
      </div>

      <div class="iter-cg">
        <label class="field-label">Iterations</label>
          <input type="number" id="iter-slider" value="31" min="1" max="500" style="width:80px;">
      </div>
      <div class="iter-cg">
        <label class="field-label">&nbsp;</label>
        <button class="btn btn-red" onclick="generateAllIterations()">‚ñ∂ Show All</button>
      </div>

    </div>

    <-- Period detection banner -->
    <!-- <div id="iter-period-row" style="display:none; margin-bottom:0.75rem;">
      <div class="period-badge">
        üîÅ Period detected ‚Äî image returns to original at iteration
        <strong id="iter-period-n" style="color:var(--accent3)">?</strong>
      </div>
    </div>

    <- Iteration cards -->
    <!-- <div class="iterations-grid" id="iterationsGrid">
      <div class="empty-state">
<span class="big" aria-hidden="true">üê±</span>
<span class="up-icon" id="anim-upload-icon" aria-hidden="true">üìÇ</span>        Click <strong>Show All</strong> to generate iterations.<br>
        Upload your own image or use the built-in cat.
      </div>
    </div>

  </div>
</div>  -->

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PAGE 3 ‚Äî STEP-BY-STEP (HTA)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- <div id="page-hta" class="page">
  <div class="hero">
    <div class="hero-eyebrow">Linear Map ‚Üí Modulo</div>
    <h1>Under<br>the <em>Hood</em></h1>
    <p class="hero-sub">
      The matrix has one eigenvalue &gt; 1 and one &lt; 1 in absolute value ‚Äî it stretches
      in one direction and compresses in the other. The modulo folds everything back into
      the starting square. Watch the 10 √ó 10 colored grid get scrambled step by step.
    </p>
    <div class="formula-pill">
      A = [[1, 1], [1, 0]] &nbsp;¬∑&nbsp; (x, y)·µÄ &nbsp;mod 10
    </div>
  </div>

  <div class="wrap">

    <div class="hta-info-bar">
      <span>A = <span class="mono">[ [1, 1], [1, 0] ]</span></span>
      <span>N = <span class="mono">10</span></span>
      <span>Grid = <span class="mono">10 √ó 10 colored squares</span></span>
    </div>

    <div class="hta-iter-display">
      Iteration: <span id="hta-count">0</span>
    </div>

    <div class="hta-canvases">
      <div class="hta-col" id="hta-col-before">
        <div class="lbl">Current State</div>
        <canvas id="hta-before" width="280" height="280"></canvas>
      </div>
      <div class="hta-col" id="hta-col-linear" style="opacity:0.25;">
        <div class="lbl">Linear Map (before mod)</div>
        <canvas id="hta-linear" width="280" height="280"></canvas>
      </div>
      <div class="hta-col" id="hta-col-after" style="opacity:0.25;">
        <div class="lbl">After Mod N</div>
        <canvas id="hta-after" width="280" height="280"></canvas>
      </div>
    </div>

    <div class="hta-actions">
      <button class="btn btn-red"   onclick="htaApply()">Apply Transform ‚Üí</button>
      <button class="btn btn-ghost" onclick="htaReset()">‚Ü∫ Reset</button>
    </div>

  </div>
</div> -->

    <div id="page-about" class="page">
      <div class="hero">
        <h1>About the<em> Cat Map</em></h1>
        <p class="hero-sub">
          The Arnold Cat Map is a chaotic, area-preserving map on the torus,
          first described by Vladimir Arnold in the 1960s using an image of a
          cat, hence the name!.
        </p>
      </div>

      <div class="wrap">
        <div class="about-section">
          <h2>What is encryption?</h2>
          <p>
            You've probably heard of encryption before, it's how your messages,
            passwords, and photos are kept private online. Encryption takes
            something readable and scrambles it so that only someone with the
            right key can unscramble it.
          </p>
          <p>
            Most encryption works with text or numbers. But what about images?
            Can we scramble a picture the same way? The Arnold Cat Map is one
            answer to that question and it uses a surprising amount of
            interesting mathematics to do it.
          </p>
        </div>
      </div>

      <div class="about-section">
        <h2>How would you use this to encrypt an image?</h2>
        <p>Here's a simple encryption scheme using the Cat Map:</p>
        <ol class="about-steps">
          <li>Choose a matrix A ‚Äî this is your secret key. Keep it private.</li>
          <li>
            Apply the Cat Map to your image a chosen number of times ‚Äî say, 7
            steps. This is the encrypted image. It looks like noise.
          </li>
          <li>
            Send the scrambled image to your friend. Without the key, they can't
            recover it.
          </li>
          <li>
            Your friend applies the same Cat Map the remaining steps until the
            period is complete ‚Äî and the original image reappears.
          </li>
        </ol>
        <p style="margin-top: 1.2rem">
          In practice, real image encryption uses more sophisticated techniques,
          but the Cat Map is used as a component in several modern encryption
          algorithms because of its strong scrambling properties.
        </p>
      </div>

      <div class="about-section">
        <h2>So what does it actually do?</h2>
        <p>
          Imagine your image is a grid of colored squares ‚Äî like a mosaic or a
          pixel art drawing. The Cat Map takes every single square and moves it
          to a new position according to a mathematical rule. Do this once and
          the image looks scrambled. Do it again and it scrambles further. Keep
          going and eventually... it comes all the way back to the original.
          Every single pixel in exactly the right place.
        </p>
        <p>
          This is the key idea ‚Äî the scrambling is not random. It follows a
          precise rule, which means it can always be undone. That's what makes
          it useful for encryption.
        </p>
        <div class="formula-pill" style="margin: 1.5rem 0">
          (x‚Ä≤, y‚Ä≤) = ( a‚ÇÅ‚ÇÅx + a‚ÇÅ‚ÇÇy , a‚ÇÇ‚ÇÅx + a‚ÇÇ‚ÇÇy ) mod N
        </div>
        <p>
          This formula describes where each pixel at position (x, y) moves to. N
          is the size of the image. The numbers a‚ÇÅ‚ÇÅ, a‚ÇÅ‚ÇÇ, a‚ÇÇ‚ÇÅ, a‚ÇÇ‚ÇÇ form a matrix
          ‚Äî think of it as the secret key. Change the matrix and you get a
          completely different scrambling pattern.
        </p>
      </div>

      <div class="about-section">
        <h2>What is mod?</h2>
        <p>
          The <em>mod</em> part of the formula is short for modulo ‚Äî it's the
          remainder after division. For example, 13 mod 10 = 3, because 13 √∑ 10
          leaves a remainder of 3. You already use modulo every day when you
          read a clock ‚Äî 14:00 is just 14 mod 12 = 2 o'clock.
        </p>
        <p>
          In the Cat Map, mod N keeps all the pixel positions inside the image.
          Without it, pixels would fly off the edges of the grid. With it, they
          wrap around ‚Äî like a game where walking off the right edge brings you
          back on the left. Mathematicians call this a
          <em>torus</em>, the same shape as a doughnut.
        </p>
      </div>

      <div class="about-section">
        <h2>Why does it always come back?</h2>
        <p>
          Here's the surprising part. No matter what image you start with, and
          no matter what matrix you choose, the image always returns to its
          exact original state after enough steps. Always. This is guaranteed by
          mathematics.
        </p>
        <p>
          The reason is that the image is a finite grid ‚Äî for example 15√ó15 =
          225 pixels. Each pixel can only be in one of 225 positions. So there
          are only a limited number of ways to arrange them. Eventually the map
          has to repeat itself, and because it follows a strict rule, it must
          come back to the very beginning.
        </p>
        <p>
          The number of steps it takes to come back is called the
          <em>period</em>. For the classic Cat Map on a 15√ó15 grid, the period
          is 40. On a 16√ó16 grid it is only 12. The period can vary wildly
          depending on the grid size ‚Äî some sizes take hundreds of steps to
          return.
        </p>
        </div>

        <div class="about-section">
          <h2>Who invented it?</h2>
          <p>
            The map was introduced by the Russian mathematician Vladimir Arnold
            in the 1960s. He demonstrated it using a picture of a cat ‚Äî which is
            where the name comes from. Arnold made major contributions to
            mathematics and physics throughout his career, and the Cat Map
            remains one of the most well-known examples of a chaotic dynamical
            system that is simple enough to understand but rich enough to be
            genuinely interesting.
          </p>
        </div>

        <div class="about-section">
          <h2>Explore the map</h2>
          <div class="about-cards">
            <div class="about-card">
              <div class="about-card-title">
                <i class="fa-solid fa-play"></i> Animation
              </div>
              <p>
                Watch the scrambling happen in real time. Try uploading your own
                photo. Try changing the matrix and see how the period changes.
              </p>
            </div>
            <div class="about-card">
              <div class="about-card-title">
                <i class="fa-solid fa-grid"></i> All Iterations
              </div>
              <p>
                See every step laid out at once. Can you spot the moment it
                starts to look like noise? Can you find the step where it comes
                back?
              </p>
            </div>
            <div class="about-card">
              <div class="about-card-title">
                <i class="fa-solid fa-arrow-right"></i> Step-by-Step
              </div>
              <p>
                See exactly where each colored square goes at each step. Watch
                the stretching happen before the modulo folds everything back
                in.
              </p>
            </div>
          </div>
        </div>

        <div class="about-section">
          <h2>Further reading</h2>
          <ul class="about-links">
            <li>
              <a
                href="https://en.wikipedia.org/wiki/Arnold%27s_cat_map"
                target="_blank"
                rel="noopener"
              >
                Arnold's Cat Map ‚Äî Wikipedia
              </a>
            </li>
            <li>
              <a
                href="https://mathworld.wolfram.com/ArnoldsCatMap.html"
                target="_blank"
                rel="noopener"
              >
                Arnold's Cat Map ‚Äî Wolfram MathWorld
              </a>
            </li>
            <li>
              <a
                href="https://en.wikipedia.org/wiki/Torus"
                target="_blank"
                rel="noopener"
              >
                What is a Torus? ‚Äî Wikipedia
              </a>
            </li>
            <li>
              <a
                href="https://en.wikipedia.org/wiki/Modular_arithmetic"
                target="_blank"
                rel="noopener"
              >
                Modular Arithmetic ‚Äî Wikipedia
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Scripts ‚Äî order matters: shared utilities first, then page modules, then nav -->
    <script src="js/shared.js"></script>
    <script src="js/iterations.js"></script>
    <script src="js/animation.js"></script>
    <script src="js/hta.js"></script>
    <script src="js/nav.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        initAnim();
      });
    </script>
  </body>
</html>
